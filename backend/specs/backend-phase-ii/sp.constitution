# Backend Constitution - Phase II Hackathon II Todo App

## Backend Purpose
The backend serves as the authoritative API layer for the Todo App, providing secure authentication verification, data persistence, and business logic enforcement. It acts as the single source of truth for user data and task management, ensuring data integrity and user isolation across all operations.

## Scope of Responsibility
- API design and implementation following RESTful principles
- Authentication and authorization using JWT tokens
- Database schema design and data persistence
- Business logic enforcement and validation
- User identity verification and session management
- Task ownership enforcement and data isolation
- API contract definition and documentation
- Input validation and error handling
- Data security and privacy enforcement

## Out of Scope
- Frontend UI logic and rendering
- Frontend routing and navigation
- Authentication UI components or forms
- Styling, CSS, or visual presentation
- Client-side state management
- Frontend framework-specific concerns
- Browser-specific functionality
- User interface animations or transitions

## Authentication & Security Rules
- JWT-based authentication verification: All protected endpoints must validate JWT tokens
- User identity must be derived from JWT token: Never trust user-provided identity data
- User isolation must be enforced at all times: Users can only access their own data
- Requests without valid tokens must be rejected: Unauthorized requests return 401 status

## Data Rules
- Tasks always belong to exactly one authenticated user: Each task has a single owner
- Backend must never return or modify tasks of another user: Cross-user data access is forbidden
- All validation and ownership checks happen in backend: Never delegate security to frontend
- Backend is the source of truth for task state: All data modifications must be validated server-side

## Reusable Agents & Skills
- Global agents and skills may exist in the root `.claude/agents` and `.claude/skills` folders
- Backend work may reuse these agents and skills when relevant and appropriate
- Reusable agents must respect backend scope boundaries
- Backend-specific decisions must not be overridden by frontend-focused agents
- Agents should be used as guidance, not as authority over specs

## Spec-Driven Rules
- Backend implementation must always follow written specs: No implementation without spec
- No implementation without a corresponding spec: Specs are required before coding
- Specs are the source of truth, not assumptions: Follow written requirements exactly
- If a spec is unclear, it must be refined before implementation: Seek clarification first

## Collaboration Rules
- Backend consumes API contracts defined in specs: Follow documented interfaces
- Backend does not assume frontend behavior: Design for general API consumption
- Backend exposes stable APIs but does not control UI: Let frontend determine presentation
- Backend agents must respect skill and domain boundaries: Maintain clear separation of concerns

## Prompt History Recording Rule
- Every `/sp.*` command (create, update, implement, plan, tasks, specify) must have its full prompt text recorded
- The prompt must be saved under: backend/history/prompts/
- Each prompt should be stored as a separate markdown file
- Filenames should include: order number, command name, short description
- Example filename: 001-sp.constitution-create-backend-constitution.md
- History is for traceability and learning only
- History files are NOT a source of truth
- Specs and constitution always override history
